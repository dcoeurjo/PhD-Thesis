%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 20 20 280 280
%%Title:C:\users\jpr\cercles\separe\fig1.eps
%%Creator:jpreve
%%CreationDate: Thu March 30 2001
%%Pages: 1
%%EndComments
%%Page: 1 1
%BeginDocument: C:\users\jpr\cercles\separe\fig1.eps

/Times-Roman findfont 20 scalefont setfont 

/u {10 mul} def
/r 4 def
/cS {1 0 0 setrgbcolor} def
/cT {0 0 1 setrgbcolor} def

/S [[4 -20] [7 -19] [11 -17] [17 -11] [19 -7] [20 -4]] def
/T [[0 -21] [6 -20] [12 -17] [17 -12] [20 -6] [21 0]]  def
/Caus [[17 -17] [130 18 div -10 9 div] [250 82 div 150 41 div] [-1950 178 div 2770 178 div] [-310 14 div 310 14 div] [-2770 178 div 1950 178 div] [-150 41 div -250 82 div] [10 9 div -130 18 div]] def

/seg { 
 {u} forall  moveto 
 {u} forall lineto
 } def

%usage : P Q med
/med{ 
aload pop 3 -1 roll aload pop [ 5 1 roll ] {u} forall
4 copy                % Qx Qy Px Py Qx Qy Px Py 
4 1 roll exch 4 -1 roll % Qx Px Qy Py 
add 2 div             % Qx Px (Py+Qy)/2
3 1 roll              % (Py+Qy)/2 Qx Px 
add 2 div             %  (Py+Qy)/2 (Px+Qx)/2                  
exch  moveto          %  (Px+Qx)/2 (Py+Qy)/2
% i.e. on démarre un chemin graphique au milieu du segment PQ
4 1 roll exch 4 -1 roll % Qx Px Qy Py, on continue à dépiler
 sub neg            % Qx Px -(Qy-Py)
3 1 roll         % -(Qy-Py) Qx Px 
sub         %   -(Qy-Py) Qx-Px
dup 0 le
  {neg exch neg exch  
  }if                 % direction orthogonale
  2 copy dup mul exch dup mul add sqrt /N exch def
  250 N div /N exch def
  N mul exch N mul exch % on affiche des morceaux de médiatrices de même longueur
  rlineto
}def


20 20 275 260 rectclip 
50 250 translate
S {aload pop u exch u exch r 0 360 arc cS fill} forall

T {aload pop u exch u exch r 0 360 arc cT stroke} forall
.001 setgray
.05 setlinewidth

 0 1 S length 1 sub
 {S exch get /P exch def
   0 1 T length 1 sub 
    {T exch get /Q exch def 
       P Q seg
       stroke
       .005 setlinewidth
       P Q med       
       stroke
     }for
  }for

Caus 0 get aload pop moveto
1 1 Caus length 1 sub 
     {
      Caus exch get aload pop  
      lineto
      } for
1 0 0 setrgbcolor
1 setlinewidth 
gsave
  stroke
grestore        
1 1 0 setrgbcolor fill  

showpage
%%EndDocument
%%Trailer
